<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Samemo ‚Äî Pr√©pa Bac Tampon</title>

<style>
:root{
  --primary:#0f766e;
  --success:#16a34a;
  --error:#dc2626;
  --bg:#f8fafc;
  --card:#ffffff;
  --border:#e5e7eb;
}
*{box-sizing:border-box}
body{margin:0;font-family:system-ui,sans-serif;background:var(--bg)}
.app{max-width:480px;margin:auto;padding:16px}
.header{text-align:center;margin-bottom:16px}
.logo{font-size:28px;font-weight:900;color:var(--primary)}
.subtitle{font-size:14px;color:#475569}
.card{
  background:var(--card);
  border-radius:12px;
  padding:16px;
  margin-bottom:12px;
  box-shadow:0 8px 20px rgba(0,0,0,.05)
}
.list-item{
  padding:10px;
  border-bottom:1px solid var(--border)
}
button{
  width:100%;
  padding:12px;
  border:none;
  border-radius:10px;
  font-weight:700;
  margin-top:8px;
  cursor:pointer
}
.primary{background:var(--primary);color:#fff}
.success{background:var(--success);color:#fff}
.error{background:var(--error);color:#fff}
.hidden{display:none}
.badge{
  padding:4px 8px;
  border-radius:8px;
  font-size:12px;
  font-weight:700
}
.badge.low{background:#fee2e2;color:#b91c1c}
</style>
</head>

<body>

<div class="app">

  <div class="header">
    <div class="logo">SAMEMO</div>
    <div class="subtitle">Pr√©paration Bac Tampon</div>
  </div>

  <div id="message" class="card hidden"></div>

  <div id="bacsList" class="card">
    <h3>Bacs tampon √† compl√©ter</h3>
    <div id="bacs"></div>
  </div>

</div>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbw4CJBufpFeLSzZvyOcbVA5fBIERBCppbKla-QMEQmZWXkY0ndBIAYAxGmm0nNXmqud/exec";

let bacsData = [];

async function loadBacs(){
  try{
    const res = await fetch(`${API_URL}?action=bacsTampon`);
    const json = await res.json();

    if(!json.success){
      showMessage(json.error || "Erreur API", "error");
      return;
    }

    bacsData = json.data;
    renderBacs();

  }catch(err){
    showMessage("Erreur r√©seau", "error");
  }
}

function showMessage(txt, type){
  const m = document.getElementById("message");
  m.textContent = txt;
  m.className = "card " + type;
  m.classList.remove("hidden");
  setTimeout(()=>m.classList.add("hidden"),3000);
}

function renderBacs(){
  const div = document.getElementById("bacs");
  div.innerHTML = "";

  if(!bacsData || bacsData.length === 0){
    div.innerHTML = "<em>Aucun bac √† compl√©ter üëç</em>";
    return;
  }

  bacsData.forEach(b=>{
    const item = document.createElement("div");
    item.className="list-item";
    item.innerHTML = `
      <strong>${b.BAC_ID}</strong><br>
      ${b.PRODUIT_NOM}<br>
      ${b.QTY_ACTUEL} / ${b.QTY_MAX}
      <span class="badge low">√Ä remplir</span>
    `;
    div.appendChild(item);
  });
}

// INIT
loadBacs();
</script>

</body>
</html>
